SET(NIF_COMPILE_FLAGS)
SET(NIF_LINK_FLAGS)

INCLUDE_DIRECTORIES("..")

IF(LIBUSB_FOUND)
  IF(LIBFTDI_FOUND)
    INSTALL(FILES FalconLibFTDIComm.h DESTINATION "/usr/local/include/falcon/comm")
    ADD_LIBRARY (nifalcon_libftdi_comm FalconLibFTDIComm.cpp)    
    SET_TARGET_PROPERTIES(nifalcon_libftdi_comm PROPERTIES OUTPUT_NAME nifalcon_libftdi_comm)
    SET_TARGET_PROPERTIES (nifalcon_libftdi_comm PROPERTIES VERSION ${LIBNIFVERSION})
    TARGET_LINK_LIBRARIES(nifalcon_libftdi_comm ${LIBFTDI})
    INSTALL(TARGETS nifalcon_libftdi_comm LIBRARY DESTINATION "/usr/local/lib" ARCHIVE DESTINATION "/usr/local/lib")
    IF(APPLE)
      SET_TARGET_PROPERTIES(nifalcon_libftdi_comm PROPERTIES INSTALL_NAME_DIR "/usr/local/lib")
    ENDIF(APPLE)
  ENDIF(LIBFTDI_FOUND)
ENDIF(LIBUSB_FOUND)

IF(LIBFTD2XX_FOUND)
    INSTALL(FILES FalconFTD2XXComm.h DESTINATION "/usr/local/include/falcon/comm")
    ADD_LIBRARY (nifalcon_ftd2xx_comm FalconFTD2XXComm.cpp)    
    SET_TARGET_PROPERTIES(nifalcon_ftd2xx_comm PROPERTIES OUTPUT_NAME nifalcon_ftd2xx_comm)
    SET_TARGET_PROPERTIES (nifalcon_ftd2xx_comm PROPERTIES VERSION ${LIBNIFVERSION})
    TARGET_LINK_LIBRARIES(nifalcon_ftd2xx_comm ${LIBFTD2XX})
    INSTALL(TARGETS nifalcon_ftd2xx_comm LIBRARY DESTINATION "/usr/local/lib" ARCHIVE DESTINATION "/usr/local/lib")
    IF(APPLE)
      SET_TARGET_PROPERTIES(nifalcon_ftd2xx_comm PROPERTIES INSTALL_NAME_DIR "/usr/local/lib")
    ENDIF(APPLE)
ENDIF(LIBFTD2XX_FOUND)
